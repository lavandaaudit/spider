<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>IBONIRIUM ¬∑ Terrarium ¬∑ EXP‚Äë03 ¬∑ –ì–µ–æ–º–µ—Ç—Ä–∏—á–Ω–µ –ü–∞–≤—É—Ç–∏–Ω–Ω—è</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
html, body {
  width:100%; height:100%;
  background:#000;
  overflow:hidden;
}
canvas { position:fixed; inset:0; }
#sensors{ position:fixed; left:0; right:0; bottom:0; height:140px; pointer-events:none; }
#info {
  position:fixed;
  bottom:12px; left:12px;
  font-family:monospace;
  color:#88ffcc;
  font-size:12px;
  line-height:1.4;
  opacity:0.85;
}
#panel {
  position:fixed;
  bottom:12px; right:12px;
  max-width:360px;
  font-family:monospace;
  font-size:12px;
  color:#c7ffd9;
  line-height:1.45;
  background:linear-gradient(to left,rgba(0,0,0,0.65),transparent);
  padding:10px 14px;
}
</style>
</head>
<body>
<canvas id="stars"></canvas>
<canvas id="terrarium"></canvas>
<canvas id="sensors"></canvas>

<div id="info">
<b>IBONIRIUM ¬∑ LAB TERRARIUM ¬∑ EXP‚Äë03</b><br>
Phase: <span id="phase">Growth</span><br>
Day: <span id="day">‚Äì</span><br>
Solar SSN: <span id="ssn">‚Äì</span><br>
Solar Factor: <span id="sf">‚Äì</span><br>
Activity: <span id="ge">‚Äì</span><br>
Target: 13 December
</div>

<div id="panel">
<b>–°–¢–ê–ù –ï–ö–°–ü–ï–†–ò–ú–ï–ù–¢–£</b><br>
–ì–µ–æ–º–µ—Ç—Ä–∏—á–Ω–µ –ø–∞–≤—É—Ç–∏–Ω–Ω—è (–≤–∏–¥ –∑–≤–µ—Ä—Ö—É). –ß—ñ—Ç–∫–∞ —Ä–∞–¥—ñ–∞–ª—å–Ω–æ-—Å–ø—ñ—Ä–∞–ª—å–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∞–≥—É—î –Ω–∞ —Å–æ–Ω—è—á–Ω—ñ –¥–∞–Ω—ñ NOAA.<br>
–ë—ñ–ª—å—à–µ —Ä–∞–¥—ñ—É—Å—ñ–≤, —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–∞ —Å–ø—ñ—Ä–∞–ª—å, —á–∏—Å—Ç–∞ –≥–µ–æ–º–µ—Ç—Ä—ñ—è ‚Äî –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–æ–Ω—è—á–Ω–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ä–æ—Å—Ç–µ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –µ–ª–µ–º–µ–Ω—Ç—ñ–≤, —Ä–æ–∑–º—ñ—Ä —ñ —â—ñ–ª—å–Ω—ñ—Å—Ç—å.<br><br>
–î–æ <b>13 –≥—Ä—É–¥–Ω—è</b> ‚Äî —Ñ–∞–∑–∞ —Ä–æ—Å—Ç—É. –ü–æ—Ç—ñ–º —Ñ—ñ–∫—Å–∞—Ü—ñ—è.
</div>

<script>
/* CANVAS */
const starCanvas = document.getElementById('stars');
const tCanvas   = document.getElementById('terrarium');
const sensorCanvas = document.getElementById('sensors');

const sctx = starCanvas.getContext('2d');
const tctx = tCanvas.getContext('2d');
const scx  = sensorCanvas.getContext('2d');

function resize(){
  starCanvas.width = tCanvas.width = sensorCanvas.width = innerWidth;
  starCanvas.height = tCanvas.height = innerHeight;
  sensorCanvas.height = 140;
}
addEventListener('resize', resize); resize();

/* –ó—ñ—Ä–∫–∏ ‚Äî –ø–æ–≤—ñ–ª—å–Ω—ñ */
const stars = Array.from({length:300},()=>({x:Math.random(),y:Math.random(),z:Math.random()*0.8+0.2}));
function drawStars(){
  sctx.clearRect(0,0,starCanvas.width,starCanvas.height);
  stars.forEach(st=>{
    st.y += 0.00008 * st.z;
    if(st.y>1) st.y=0;
    sctx.globalAlpha = 0.25 + st.z*0.4;
    sctx.fillStyle="#ddd";
    sctx.beginPath();
    sctx.arc(st.x*starCanvas.width, st.y*starCanvas.height, st.z*1.1, 0, Math.PI*2);
    sctx.fill();
  });
  sctx.globalAlpha=1;
}

/* NOAA */
let solarFactor = 1;
let solarSSN = 0;
let activity = 0;

async function updateSolar(){
  try{
    const r = await fetch('https://services.swpc.noaa.gov/json/solar-cycle/predicted-solar-cycle.json');
    const d = await r.json();
    const l = d[d.length-1];
    solarSSN = l.predicted_ssn;
    solarFactor = Math.min(4, 0.7 + solarSSN/100);
    activity = solarFactor * (0.6 + Math.random()*0.4);
    
    document.getElementById('ssn').textContent = solarSSN.toFixed(1);
    document.getElementById('sf').textContent  = solarFactor.toFixed(2);
    document.getElementById('ge').textContent  = activity.toFixed(2);
  }catch(e){
    solarFactor = 1.2;
  }
}
updateSolar(); setInterval(updateSolar, 1800000);

/* –ì–µ–æ–º–µ—Ç—Ä–∏—á–Ω–∞ –ø–∞–≤—É—Ç–∏–Ω–∞ */
class GeometricWeb {
  constructor(x, y) {
    this.cx = x;
    this.cy = y;
    this.growth = 0;
    this.maxGrowth = 18 + Math.random()*12;

    this.offset = Math.random();
    this.dir = Math.random() < 0.5 ? 1 : -1;
    this.speed = 0.0003 + Math.random()*0.0005;

    this.radials = 16 + Math.floor(solarFactor * 8);     // –±—ñ–ª—å—à–µ —Ä–∞–¥—ñ—É—Å—ñ–≤ –ø—Ä–∏ –≤–∏—Å–æ–∫—ñ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
    this.maxRad  = 90 + solarFactor * 60;
    this.spiralDensity = 0.18 + solarFactor * 0.08;      // —â—ñ–ª—å–Ω—ñ—à–∞ —Å–ø—ñ—Ä–∞–ª—å
    this.spiderSize = 2.5 + solarFactor * 1.2;
  }

  grow() {
    if (this.growth < this.maxGrowth) {
      this.growth += 0.028 * solarFactor;
    }
    this.radials = 16 + Math.floor(solarFactor * 8);
    this.maxRad  = 90 + solarFactor * 60;
    this.spiralDensity = 0.18 + solarFactor * 0.08;
    this.spiderSize = 2.5 + solarFactor * 1.2;
    this.speed = (0.0003 + Math.random()*0.0005) * solarFactor * 1.3;

    this.offset += this.dir * this.speed;
    if (this.offset > 1) this.offset -= 1;
    if (this.offset < 0) this.offset += 1;
  }

  draw() {
    // –†–∞–¥—ñ–∞–ª—å–Ω—ñ –Ω–∏—Ç–∫–∏ ‚Äî —á—ñ—Ç–∫—ñ, —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω—ñ
    tctx.strokeStyle = "rgba(200,220,255,0.45)";
    tctx.lineWidth = 0.7;
    for (let i = 0; i < this.radials; i++) {
      const angle = i * (Math.PI * 2 / this.radials);
      const ex = this.cx + Math.cos(angle) * this.maxRad;
      const ey = this.cy + Math.sin(angle) * this.maxRad;
      tctx.beginPath();
      tctx.moveTo(this.cx, this.cy);
      tctx.lineTo(ex, ey);
      tctx.stroke();
    }

    // –°–ø—ñ—Ä–∞–ª—å ‚Äî —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–∞ (arithmetic / quasi-log), –±–µ–∑ —Å–∏–ª—å–Ω–æ–≥–æ —à—É–º—É
    tctx.strokeStyle = "rgba(220,240,255,0.55)";
    tctx.lineWidth = 0.6;
    tctx.beginPath();
    let prevX, prevY;
    const steps = Math.min(this.growth, this.maxGrowth) * 25;
    for (let i = 0; i <= steps; i++) {
      const t = i / steps;
      const radius = t * this.maxRad;
      const angle = t * Math.PI * 2 * (this.spiralDensity * 15);  // –±–∞–≥–∞—Ç–æ –≤–∏—Ç–∫—ñ–≤
      const x = this.cx + Math.cos(angle) * radius;
      const y = this.cy + Math.sin(angle) * radius;
      if (i === 0) tctx.moveTo(x, y);
      else tctx.lineTo(x, y);
    }
    tctx.stroke();

    // –ü–∞–≤—É–∫ ‚Äî –º–∞–ª–µ–Ω—å–∫–∏–π, –≥–µ–æ–º–µ—Ç—Ä–∏—á–Ω–∏–π, —à–≤–∏–¥–∫–∏–π
    const spiderR = this.offset * this.maxRad * 0.92;
    const spiderA = this.offset * Math.PI * 2 * 12;  // –±–∞–≥–∞—Ç–æ –æ–±–µ—Ä—Ç—ñ–≤
    const px = this.cx + Math.cos(spiderA) * spiderR;
    const py = this.cy + Math.sin(spiderA) * spiderR;

    const tremor = Math.sin(Date.now() * 0.012 + this.cx) * 0.4;

    tctx.fillStyle = "rgba(30,20,50,0.9)";
    tctx.beginPath();
    tctx.arc(px + tremor, py, this.spiderSize, 0, Math.PI*2);
    tctx.fill();

    tctx.strokeStyle = "rgba(60,50,90,0.7)";
    tctx.lineWidth = 1;
    for (let l = 0; l < 8; l++) {
      const la = l * Math.PI * 2 / 8 + tremor * 0.2;
      const len = this.spiderSize * 1.8 + Math.sin(Date.now()*0.006 + l)*1;
      const ex = px + Math.cos(la) * len;
      const ey = py + Math.sin(la) * len;
      tctx.beginPath();
      tctx.moveTo(px, py);
      tctx.lineTo(ex, ey);
      tctx.stroke();
    }
  }
}

const webs = Array.from({length:22}, () => new GeometricWeb(
  Math.random() * tCanvas.width,
  Math.random() * tCanvas.height * 0.85 + tCanvas.height * 0.1
));

/* SENSORS */
function drawSensors(){
  scx.clearRect(0,0,sensorCanvas.width,sensorCanvas.height);
  const baseY = 110;

  scx.strokeStyle='rgba(120,255,180,0.15)';
  scx.beginPath(); scx.moveTo(0,baseY); scx.lineTo(sensorCanvas.width,baseY); scx.stroke();

  scx.fillStyle='rgba(255,220,140,0.75)';
  scx.beginPath();
  scx.arc(80, baseY-40, 9 + solarFactor*4.5, 0, Math.PI*2);
  scx.fill();
  scx.fillStyle="#fff"; scx.font="11px monospace";
  scx.fillText('‚òÄ SSN', 55, baseY+20);

  scx.strokeStyle='rgba(160,220,255,0.75)';
  scx.beginPath();
  scx.moveTo(160, baseY);
  scx.lineTo(160, baseY - activity*32);
  scx.stroke();
  scx.fillText('üß¨ –≥–µ–æ–º–µ—Ç—Ä—ñ—è', 130, baseY+20);

  const now = new Date();
  const t = Math.min(1, (now - START_DATE) / (STOP_DATE - START_DATE));
  scx.strokeStyle='rgba(200,200,255,0.6)';
  scx.beginPath();
  scx.arc(260, baseY, 30, -Math.PI/2, -Math.PI/2 + t*Math.PI*2);
  scx.stroke();
  scx.fillText('‚è≥', 245, baseY+20);
}

/* LOOP */
const START_DATE = new Date('2026-01-01');
const STOP_DATE  = new Date('2026-12-13');

function updateDay(){
  const now = new Date();
  const day = Math.floor((now - START_DATE) / 86400000);
  document.getElementById('day').textContent = day >= 0 ? day : '‚Äì';
  document.getElementById('phase').textContent = now < STOP_DATE ? 'Growth' : 'Final';
}
setInterval(updateDay, 60000);
updateDay();

function loop(){
  drawStars();
  drawSensors();

  if (new Date() < STOP_DATE) {
    tctx.clearRect(0,0,tCanvas.width,tCanvas.height);
    webs.forEach(w => { w.grow(); w.draw(); });
  }

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
