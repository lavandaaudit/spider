<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>IBONIRIUM ¬∑ Terrarium ¬∑ EXP‚Äë03 ¬∑ –ü–∞–≤—É—Ç–∏–Ω–Ω—è –ó–≤–µ—Ä—Ö—É</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
html, body {
  width:100%; height:100%;
  background:#000;
  overflow:hidden;
}
canvas { position:fixed; inset:0; }
#sensors{ position:fixed; left:0; right:0; bottom:0; height:140px; pointer-events:none; }
#info {
  position:fixed;
  bottom:12px; left:12px;
  font-family:monospace;
  color:#9affc2;
  font-size:12px;
  line-height:1.4;
  opacity:0.9;
}
#panel {
  position:fixed;
  bottom:12px; right:12px;
  max-width:360px;
  font-family:monospace;
  font-size:12px;
  color:#c7ffd9;
  line-height:1.45;
  background:linear-gradient(to left,rgba(0,0,0,0.6),transparent);
  padding:10px 14px;
}
</style>
</head>
<body>
<canvas id="stars"></canvas>
<canvas id="terrarium"></canvas>
<canvas id="sensors"></canvas>

<div id="info">
<b>IBONIRIUM ¬∑ LAB TERRARIUM ¬∑ EXP‚Äë03</b><br>
Phase: <span id="phase">Growth</span><br>
Day: <span id="day">‚Äì</span><br>
Solar SSN: <span id="ssn">‚Äì</span><br>
Solar Factor: <span id="sf">‚Äì</span><br>
Activity: <span id="ge">‚Äì</span><br>
Target: 13 December
</div>

<div id="panel">
<b>–°–¢–ê–ù –ï–ö–°–ü–ï–†–ò–ú–ï–ù–¢–£</b><br>
–ñ–∏–≤–∏–π —Ç–µ—Ä–∞—Ä—ñ—É–º –ø–∞–≤—É—Ç–∏–Ω–Ω—è (–≤–∏–¥ –∑–≤–µ—Ä—Ö—É). –ü–∞–≤—É—Ç–∏–Ω–∏ —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–æ—ó –≥–µ–æ–º–µ—Ç—Ä—ñ—ó —Ä–µ–∞–≥—É—é—Ç—å –Ω–∞ —Å–æ–Ω—è—á–Ω—ñ –¥–∞–Ω—ñ NOAA.<br>
–ü–∞–≤—É–∫–∏ —Ä—É—Ö–∞—é—Ç—å—Å—è, –∑–º—ñ–Ω—é—é—Ç—å –ø–∞–≤—É—Ç–∏–Ω—É (—Ä–æ–∑–º—ñ—Ä, –≥—É—Å—Ç–æ—Ç—É) —Ç–∞ —Å–∞–º—ñ –∑–º—ñ–Ω—é—é—Ç—å—Å—è (—Ä–æ–∑–º—ñ—Ä, —à–≤–∏–¥–∫—ñ—Å—Ç—å) –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–æ–Ω—è—á–Ω–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ.<br><br>
–î–æ <b>13 –≥—Ä—É–¥–Ω—è</b> ‚Äî —Ñ–∞–∑–∞ —Ä–æ—Å—Ç—É. –ü–æ—Ç—ñ–º —Ñ—ñ–∫—Å–∞—Ü—ñ—è.
</div>

<script>
/* CANVAS */
const starCanvas = document.getElementById('stars');
const tCanvas   = document.getElementById('terrarium');
const sensorCanvas = document.getElementById('sensors');

const sctx = starCanvas.getContext('2d');
const tctx = tCanvas.getContext('2d');
const scx  = sensorCanvas.getContext('2d');

function resize(){
  starCanvas.width = tCanvas.width = sensorCanvas.width = innerWidth;
  starCanvas.height = tCanvas.height = innerHeight;
  sensorCanvas.height = 140;
}
addEventListener('resize', resize); resize();

/* –ó—ñ—Ä–∫–∏ */
const stars = Array.from({length:240},()=>({x:Math.random(),y:Math.random(),z:Math.random()}));
function drawStars(){
  sctx.clearRect(0,0,starCanvas.width,starCanvas.height);
  stars.forEach(st=>{
    st.y += 0.00025*(1+st.z);
    if(st.y>1) st.y=0;
    sctx.globalAlpha = 0.3 + st.z*0.6;
    sctx.fillStyle="#fff";
    sctx.beginPath();
    sctx.arc(st.x*starCanvas.width, st.y*starCanvas.height, st.z*1.4, 0, Math.PI*2);
    sctx.fill();
  });
  sctx.globalAlpha=1;
}

/* –®—É–º –¥–ª—è –≤–∏–ø–∞–¥–∫–æ–≤–æ—Å—Ç—ñ */
function noise(x, y) {
  return Math.sin(x*12.989 + y*78.233) * 43758.5453 % 1;
}

/* NOAA */
let solarFactor = 1;
let solarSSN = 0;
let activity = 0;

async function updateSolar(){
  try{
    const r = await fetch('https://services.swpc.noaa.gov/json/solar-cycle/predicted-solar-cycle.json');
    const d = await r.json();
    const l = d[d.length-1];
    solarSSN = l.predicted_ssn;
    solarFactor = Math.min(3.5, 0.6 + solarSSN/110);
    activity = solarFactor * (0.7 + Math.random()*0.3);
    
    document.getElementById('ssn').textContent = solarSSN.toFixed(1);
    document.getElementById('sf').textContent  = solarFactor.toFixed(2);
    document.getElementById('ge').textContent  = activity.toFixed(2);
  }catch(e){
    solarFactor = 1;
  }
}
updateSolar(); setInterval(updateSolar, 1800000);

/* –ü–∞–≤—É—Ç–∏–Ω–∞ + –ø–∞–≤—É–∫ (–≤–∏–¥ –∑–≤–µ—Ä—Ö—É, —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–∞ –≥–µ–æ–º–µ—Ç—Ä—ñ—è) */
class SpiderWeb {
  constructor(x, y) {
    this.centerX = x;
    this.centerY = y;
    this.stage = 0;
    this.max   = 20 + Math.random()*15; // —Å–ø—ñ—Ä–∞–ª—å–Ω—ñ –≤–∏—Ç–∫–∏

    this.offset = Math.random(); // –ø–æ–∑–∏—Ü—ñ—è –ø–∞–≤—É–∫–∞
    this.dir    = Math.random() < 0.5 ? 1 : -1;
    this.speed  = (0.0002 + Math.random()*0.0006) * solarFactor; // —à–≤–∏–¥–∫—ñ—Å—Ç—å –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Å–æ–Ω—Ü—è

    this.radialCount = 12 + Math.floor(solarFactor * 6); // –≥—É—Å—Ç–æ—Ç–∞ —Ä–∞–¥—ñ–∞–ª—ñ–≤
    this.spiralDensity = 0.2 + solarFactor * 0.1; // –≥—É—Å—Ç–æ—Ç–∞ —Å–ø—ñ—Ä–∞–ª—ñ
    this.maxRadius = 80 + solarFactor * 40; // —Ä–æ–∑–º—ñ—Ä –ø–∞–≤—É—Ç–∏–Ω–∏ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Å–æ–Ω—Ü—è
    this.spiderSize = 3 + solarFactor * 2; // —Ä–æ–∑–º—ñ—Ä –ø–∞–≤—É–∫–∞ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Å–æ–Ω—Ü—è
  }

  grow() {
    if (this.stage < this.max) {
      this.stage += 0.02 * solarFactor; // —Ä—ñ—Å—Ç –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Å–æ–Ω—Ü—è
    }
    // –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–æ–Ω—Ü—è (–∑–º—ñ–Ω—é—é—Ç—å –ø–∞–≤—É—Ç–∏–Ω—É —Ç–∞ –ø–∞–≤—É–∫–∞)
    this.radialCount = 12 + Math.floor(solarFactor * 6);
    this.spiralDensity = 0.2 + solarFactor * 0.1;
    this.maxRadius = 80 + solarFactor * 40;
    this.spiderSize = 3 + solarFactor * 2;
    this.speed = (0.0002 + Math.random()*0.0006) * solarFactor;

    // —Ä—É—Ö –ø–∞–≤—É–∫–∞
    this.offset += this.dir * this.speed;
    if (this.offset > 1) this.offset -= 1;
    if (this.offset < 0) this.offset += 1;
  }

  draw() {
    // —Ä–∞–¥—ñ–∞–ª—å–Ω—ñ –Ω–∏—Ç–∫–∏ (—Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω—ñ, –∑ –ª–µ–≥–∫–∏–º –≤–∏–≥–∏–Ω–æ–º —á–µ—Ä–µ–∑ —à—É–º)
    tctx.strokeStyle = "rgba(220,220,240,0.6)";
    tctx.lineWidth = 0.8;
    for (let r = 0; r < this.radialCount; r++) {
      const angle = r * (Math.PI * 2 / this.radialCount) + noise(r, this.centerX) * 0.1;
      const endX = this.centerX + Math.cos(angle) * this.maxRadius;
      const endY = this.centerY + Math.sin(angle) * this.maxRadius;
      tctx.beginPath();
      tctx.moveTo(this.centerX, this.centerY);
      tctx.lineTo(endX, endY);
      tctx.stroke();
    }

    // —Å–ø—ñ—Ä–∞–ª—å (–∞—Ä—Ö—ñ–º–µ–¥–æ–≤–∞, —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–∞)
    tctx.strokeStyle = "rgba(210,210,230,0.7)";
    tctx.beginPath();
    let prevX, prevY;
    for (let s = 0; s < Math.min(this.stage, this.max) * 20; s++) {
      const theta = s * this.spiralDensity;
      const rad = theta / (Math.PI * 2) * (this.maxRadius / this.max);
      const sx = this.centerX + Math.cos(theta) * rad + noise(s, this.centerY) * 1;
      const sy = this.centerY + Math.sin(theta) * rad + noise(s, this.centerX) * 1;
      if (s === 0) {
        tctx.moveTo(sx, sy);
      } else {
        tctx.lineTo(sx, sy);
      }
    }
    tctx.stroke();

    // ‚îÄ‚îÄ‚îÄ –ü–ê–í–£–ö ‚îÄ‚îÄ‚îÄ
    const spiderRad = this.offset * this.maxRadius * 0.8;
    const spiderTheta = this.offset * Math.PI * 2 * 8; // –∫—ñ–ª—å–∫–∞ –æ–±–µ—Ä—Ç—ñ–≤
    const px = this.centerX + Math.cos(spiderTheta) * spiderRad;
    const py = this.centerY + Math.sin(spiderTheta) * spiderRad;

    const tremor = Math.sin(Date.now()*0.009 + this.centerX) * 0.8;

    // —Ç—ñ–ª–æ
    tctx.fillStyle = "rgba(18,15,28,0.97)";
    tctx.beginPath();
    tctx.arc(px + tremor*0.4, py + tremor*0.7, this.spiderSize, 0, Math.PI*2);
    tctx.fill();

    // –ª–∞–ø–∫–∏
    tctx.strokeStyle = "rgba(35,30,50,0.92)";
    tctx.lineWidth = 1.3;
    for (let l = 0; l < 8; l++) {
      const legA = l * Math.PI * 2 / 8 + Math.PI/4 + tremor*0.25;
      const lenLeg = 7 + Math.sin(Date.now()*0.004 + l*2 + this.centerX)*2.2 + this.spiderSize * 0.5;
      const ex = px + Math.cos(legA) * lenLeg;
      const ey = py + Math.sin(legA) * lenLeg;
      tctx.beginPath();
      tctx.moveTo(px, py);
      tctx.lineTo(ex, ey);
      tctx.stroke();
    }
  }
}

const webs = Array.from({length:25}, () => new SpiderWeb(Math.random() * tCanvas.width, Math.random() * tCanvas.height * 0.9));

/* SENSORS */
function drawSensors(){
  scx.clearRect(0,0,sensorCanvas.width,sensorCanvas.height);
  const baseY = 110;

  scx.strokeStyle='rgba(120,255,180,0.2)';
  scx.beginPath(); scx.moveTo(0,baseY); scx.lineTo(sensorCanvas.width,baseY); scx.stroke();

  scx.fillStyle='rgba(255,200,120,0.8)';
  scx.beginPath();
  scx.arc(80, baseY-40, 10 + solarFactor*4, 0, Math.PI*2);
  scx.fill();
  scx.fillStyle="#fff"; scx.font="11px monospace";
  scx.fillText('‚òÄ —Å–æ–Ω—Ü–µ', 50, baseY+20);

  scx.strokeStyle='rgba(180,220,255,0.8)';
  scx.beginPath();
  scx.moveTo(160, baseY);
  scx.lineTo(160, baseY - activity*28);
  scx.stroke();
  scx.fillText('üï∏ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å', 135, baseY+20);

  const now = new Date();
  const t = Math.min(1, (now - START_DATE) / (STOP_DATE - START_DATE));
  scx.strokeStyle='rgba(180,180,255,0.7)';
  scx.beginPath();
  scx.arc(260, baseY, 30, -Math.PI/2, -Math.PI/2 + t*Math.PI*2);
  scx.stroke();
  scx.fillText('‚è≥ —Ü–∏–∫–ª', 235, baseY+20);
}

/* LOOP */
const START_DATE = new Date('2026-01-01');
const STOP_DATE  = new Date('2026-12-13');

function updateDay(){
  const now = new Date();
  const day = Math.floor((now - START_DATE) / (86400000));
  document.getElementById('day').textContent = day >= 0 ? day : '‚Äì';
  document.getElementById('phase').textContent = now < STOP_DATE ? 'Growth' : 'Final';
}
setInterval(updateDay, 60000);
updateDay();

function loop(){
  drawStars();
  drawSensors();

  if (new Date() < STOP_DATE) {
    tctx.clearRect(0,0,tCanvas.width,tCanvas.height);
    webs.forEach(w => { w.grow(); w.draw(); });
  }

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
